!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},o=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?n(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const n=e.querySelector(t.submitButtonSelector),a=Array.from(e.querySelectorAll(t.inputSelector));o(a,n,t),a.forEach((c=>{c.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,c,t),o(a,n,t)}))}))})(t,e)}))};a(t);var c=e+"d3610e9c6dce3cb370d8.svg",s=e+"2fc47fd8e9a9bcd9612f.jpg",l=e+"d38272e02bb4f1ab1c37.svg",d=e+"40608da7369d39bc1077.svg",i=e+"e42436bfddd4005c65d7.png";function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?o:r}document.getElementById("spots-logo").src=c;const m=document.getElementById("profile-avatar");m.src=s,document.getElementById("profile-pencil-icon").src=l,document.getElementById("profile-avatar-pencil-icon").src=i,document.getElementById("plus-icon").src=d;const _=document.querySelectorAll(".modal"),h=document.querySelector(".profile__edit-button"),f=document.querySelector(".profile__name"),v=document.querySelector(".profile__description"),y=document.querySelector("#edit-profile-modal"),p=y.querySelector("#modal__form"),b=y.querySelector("#profile-name-input"),S=y.querySelector("#profile-description-input"),E=document.querySelector(".profile__avatar-btn"),q=document.querySelector("#card-template"),k=document.querySelector(".cards__list"),g=document.querySelector("#add-card-modal"),L=document.querySelector(".profile__add-button"),C=g.querySelector(".modal__form"),$=(document.querySelector(".card__like-button"),g.querySelector("#add-card-link-input")),j=g.querySelector("#add-card-name-input"),I=g.querySelector(".modal__submit-button"),x=document.querySelector("#preview__modal"),U=x.querySelector(".modal__image"),A=x.querySelector(".modal__caption"),P=document.querySelector("#edit-avatar-modal"),B=P.querySelector(".modal__form"),D=(P.querySelector(".modal__submit-button"),P.querySelector("#profile-avatar-input")),T=document.querySelector("#delete-card-modal"),w=T.querySelector(".modal__form"),N=document.querySelectorAll(".modal__close-button"),O=document.querySelectorAll(".modal__outter_close-button"),J=document.querySelector(".modal__cancel-button");let H,z,M;const F=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo(),this.editUserInfo])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"e11ddd60-2205-47cc-82fc-4d65d6c884b9","Content-Type":"application/json"}});function G(e){const t=q.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return e.isLiked&&n.classList.add("card__like-button_liked"),r.textContent=e.name,o.src=e.link,o.alt=e.name,o.addEventListener("click",(()=>{K(x),U.src=e.link,A.textContent=e.name,U.alt=e.name})),n.addEventListener("click",(t=>{!function(e,t){const r=e.target.classList.contains("card__like-button_liked");F.changeLikeStatus(t,r).then((t=>{e.target.classList.toggle("card__like-button_liked")})).catch(console.error)}(t,e._id)})),a.addEventListener("click",(r=>{!function(e,t){H=e,z=t,K(T)}(t,e._id)})),t}function K(e){e.classList.add("modal_opened"),document.addEventListener("keydown",R)}function Q(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",R)}function R(e){"Escape"===e.key&&Q(document.querySelector(".modal_opened"))}F.getAppInfo().then((e=>{let[t,r]=e;M=r._id,t.forEach((e=>{const t=G(e);k.prepend(t)})),m.src=r.avatar,f.textContent=r.name,v.textContent=r.about})).catch(console.error),N.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>Q(t)))})),O.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>Q(t)))})),h.addEventListener("click",(()=>{var e;b.value=f.textContent,S.value=v.textContent,e=p,[b,S].forEach(((t,o)=>{r(e,t,o)})),K(y)})),p.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;u(t,!0),F.editUserInfo({name:b.value,about:S.value}).then((e=>{f.textContent=e.name,v.textContent=e.about,Q(y)})).catch(console.error).finally((()=>{t.textContent="Save"}))})),L.addEventListener("click",(()=>{K(g)})),C.addEventListener("submit",(function(e){e.preventDefault();const r=e.submitter;u(r,!0);const o={name:j.value,link:$.value};F.addCard(o).then((e=>{const t=G(e);k.prepend(t),C.reset(),Q(g)})).catch((e=>{console.error(e)})).finally((()=>{n(I,t),r.textContent="Save"}))})),E.addEventListener("click",(()=>{K(P)})),B.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;u(t,!0),F.editAvatarInfo(D.value).then((e=>{m.src=e.avatar,Q(P)})).catch(console.error).finally((()=>{t.textContent="Save"}))})),w.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;u(t,!0,"Delete","Deleting..."),F.deleteCard(z).then((()=>{H.remove(),Q(T)})).catch(console.error).finally((()=>{t.textContent="Delete"}))})),_.forEach((e=>{e.addEventListener("click",(function(t){t.target.classList.contains("modal")&&Q(e)}))})),_.forEach((e=>{J.addEventListener("click",(function(t){t.target.classList.contains("modal__cancel-button")&&Q(e)}))})),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FFcEMsSUFpRUFtRCxFQUFpQjdCLGlCQUFpQixTQUFTLEtBQ3pDbUcsRUFBVTFELEVBQVksSUFFeEJDLEVBQVcxQyxpQkFBaUIsVUFsRTVCLFNBQTRCb0csR0FDMUJBLEVBQUl5QixpQkFFSixNQUFNQyxFQUFZMUIsRUFBSTJCLFVBQ3RCMUgsRUFBY3lILEdBQVcsR0FFekIxRSxFQUNHNEIsZUFBZXJDLEVBQVlpRixPQUMzQnpELE1BQU11QixJQUNMMUUsRUFBY0YsSUFBTTRFLEVBQUtULE9BQ3pCZ0MsRUFBV3hFLEVBQVksSUFFeEIrRCxNQUFNQyxRQUFRQyxPQUNkc0IsU0FBUSxLQUNQRixFQUFVcEosWUFBYyxNQUFNLEdBRXBDLElBb0RBbUUsRUFBVzdDLGlCQUFpQixVQXZJNUIsU0FBNEJvRyxHQUMxQkEsRUFBSXlCLGlCQUVKLE1BQU1DLEVBQVkxQixFQUFJMkIsVUFDdEIxSCxFQUFjeUgsR0FBVyxFQUFNLFNBQVUsZUFFekMxRSxFQUNHOEIsV0FBV2hDLEdBQ1hpQixNQUFLLEtBQ0psQixFQUFhckUsU0FDYnFJLEVBQVdyRSxFQUFZLElBRXhCNEQsTUFBTUMsUUFBUUMsT0FDZHNCLFNBQVEsS0FDUEYsRUFBVXBKLFlBQWMsUUFBUSxHQUV0QyxJQXlIQTJDLEVBQVUxQixTQUFTb0gsSUFDakJBLEVBQU0vRyxpQkFBaUIsU0FBUyxTQUFVcUksR0FDcENBLEVBQU1oQyxPQUFPMUgsVUFBVTJILFNBQVMsVUFDbENXLEVBQVdGLEVBRWYsR0FBRSxJQUdKMUYsRUFBVTFCLFNBQVNvSCxJQUNqQi9ELEVBQWFoRCxpQkFBaUIsU0FBUyxTQUFVcUksR0FDM0NBLEVBQU1oQyxPQUFPMUgsVUFBVTJILFNBQVMseUJBQ2xDVyxFQUFXRixFQUVmLEdBQUUsSUFHSnZILEVBQWlCM0IsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vdXRpbHMvaGVscGVycy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcbn07XG5cbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgZXJyb3JNZXNzYWdlLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcbiAgfVxufTtcblxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoaW5wdXRMaXN0LCBmb3JtRWwpID0+IHtcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0LCBjb25maWcpID0+IHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0LCBjb25maWcpO1xuICB9KTtcbn07XG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KFxuICBidG4sXG4gIGlzTG9hZGluZyxcbiAgZGVmdWFsdFRleHQgPSBcIlNhdmVcIixcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXG4pIHtcbiAgaWYgKGlzTG9hZGluZykge1xuICAgIGJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICB9IGVsc2Uge1xuICAgIGJ0bi50ZXh0Q29udGVudCA9IGRlZnVhbHRUZXh0O1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG5pbXBvcnQge1xuICBlbmFibGVWYWxpZGF0aW9uLFxuICBzZXR0aW5ncyxcbiAgZGlzYWJsZUJ1dHRvbixcbiAgcmVzZXRWYWxpZGF0aW9uLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG4vLyBpbWFnZXNcbmltcG9ydCBzcG90c0xvZ29TcmMgZnJvbSBcIi4uL2ltYWdlcy9zcG90cy5sb2dvLnN2Z1wiO1xuaW1wb3J0IHByb2ZpbGVBdmF0YXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9zcG90cy5hdmF0YXIuanBnXCI7XG5pbXBvcnQgZWRpdFBlbmNpbEljb25TcmMgZnJvbSBcIi4uL2ltYWdlcy9zcG90cy5lZGl0LnN2Z1wiO1xuaW1wb3J0IHBsdXNJY29uU3JjIGZyb20gXCIuLi9pbWFnZXMvcGx1cy5pY29uLnN2Z1wiO1xuaW1wb3J0IGVkaXRQZW5jaWxMaWdodEljb25TcmMgZnJvbSBcIi4uL2ltYWdlcy9zcG90cy5lZGl0LmxpZ2h0LnBuZ1wiO1xuXG5pbXBvcnQgQXBpIGZyb20gXCIuLi8uLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCB7IHNldEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vLi4vdXRpbHMvaGVscGVycy5qc1wiO1xuXG5jb25zdCBzcG90c0xvZ28gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNwb3RzLWxvZ29cIik7XG5zcG90c0xvZ28uc3JjID0gc3BvdHNMb2dvU3JjO1xuXG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlLWF2YXRhclwiKTtcbnByb2ZpbGVBdmF0YXIuc3JjID0gcHJvZmlsZUF2YXRhclNyYztcblxuY29uc3QgZWRpdFBlbmNpbEljb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2ZpbGUtcGVuY2lsLWljb25cIik7XG5lZGl0UGVuY2lsSWNvbi5zcmMgPSBlZGl0UGVuY2lsSWNvblNyYztcbmNvbnN0IHByb2ZpbGVBdmF0YXJQZW5jaWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcbiAgXCJwcm9maWxlLWF2YXRhci1wZW5jaWwtaWNvblwiXG4pO1xucHJvZmlsZUF2YXRhclBlbmNpbC5zcmMgPSBlZGl0UGVuY2lsTGlnaHRJY29uU3JjO1xuXG5jb25zdCBwbHVzSWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGx1cy1pY29uXCIpO1xucGx1c0ljb24uc3JjID0gcGx1c0ljb25TcmM7XG5cbi8vIGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiR29sZGVuIEdhdGUgQnJpZGdlXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy8gICB9LFxuLy8gXTtcblxuY29uc3QgbW9kYWxMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcblxuLy8gUHJvZmlsZVxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZmlsZU5uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsX19mb3JtXCIpO1xuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLW5hbWUtaW5wdXRcIlxuKTtcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idG5cIik7XG5cbi8vIENhcmRcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcbmNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxuY29uc3QgY2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGNhcmRBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5jb25zdCBhZGRDYXJkRm9ybSA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgY2FyZExpa2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuXG4vLyBBZGQgY2FyZFxuY29uc3QgYWRkQ2FyZExpbmtJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWxpbmstaW5wdXRcIik7XG5jb25zdCBhZGRDYXJkTmFtZUlucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuXG4vLyBQcmV2aWV3IG1vZGFsXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXdfX21vZGFsXCIpO1xuY29uc3QgcHJldmlld01vZGFsSW1nID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vLyBBdmF0YXJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGF2YXRhckZvcm0gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgYXZhdGFyU3VibWl0QnRuID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1pbnB1dFwiKTtcblxuLy8gRGVrZXRlXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5jb25zdCBkZWxldGVGb3JtID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcblxuLy8gQ2xvc2UgQnV0dG9uc1xuY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuY29uc3Qgb3V0dGVyTW9kYWxDbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxuICBcIi5tb2RhbF9fb3V0dGVyX2Nsb3NlLWJ1dHRvblwiXG4pO1xuY29uc3QgY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FuY2VsLWJ1dHRvblwiKTtcblxubGV0IHNlbGVjdGVkQ2FyZDtcbmxldCBzZWxlY3RlZENhcmRJZDtcbmxldCB1c2VySWQ7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcImUxMWRkZDYwLTIyMDUtNDdjYy04MmZjLTRkNjVkNmM4ODRiOVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmFwaVxuICAuZ2V0QXBwSW5mbygpXG4gIC50aGVuKChbY2FyZHMsIHVzZXJJbmZvXSkgPT4ge1xuICAgIHVzZXJJZCA9IHVzZXJJbmZvLl9pZDtcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICAgICAgY2FyZExpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XG4gICAgfSk7XG5cbiAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXJJbmZvLmF2YXRhcjtcbiAgICBwcm9maWxlTm5hbWUudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmFib3V0O1xuICB9KVxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG5cbmNsb3NlQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgY29uc3QgcG9wdXAgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKHBvcHVwKSk7XG59KTtcblxub3V0dGVyTW9kYWxDbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gIGNvbnN0IHBvcHVwID0gYnV0dG9uLmNsb3Nlc3QoXCIubW9kYWxcIik7XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChwb3B1cCkpO1xufSk7XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gIGNvbnN0IGNhcmROYW1lRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICBjb25zdCBjYXJkSW1nRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuXG4gIGNvbnN0IGNhcmRMaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcblxuICBjb25zdCBpc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICBpZiAoaXNMaWtlZCkge1xuICAgIGNhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcbiAgfVxuXG4gIGNhcmROYW1lRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIGNhcmRJbWdFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWdFbC5hbHQgPSBkYXRhLm5hbWU7XG5cbiAgY2FyZEltZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XG5cbiAgICBwcmV2aWV3TW9kYWxJbWcuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdNb2RhbENhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgcHJldmlld01vZGFsSW1nLmFsdCA9IGRhdGEubmFtZTtcbiAgfSk7XG5cbiAgY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICBoYW5kbGVMaWtlKGV2dCwgZGF0YS5faWQpO1xuICB9KTtcblxuICBjYXJkRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YS5faWQpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVQcmVzcyk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlUHJlc3MpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIkRlbGV0ZVwiLCBcIkRlbGV0aW5nLi4uXCIpO1xuXG4gIGFwaVxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJEZWxldGVcIjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlKTtcblxuICBhcGlcbiAgICAuZWRpdFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSxcbiAgICAgIGFib3V0OiBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlLFxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHByb2ZpbGVObmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlKTtcblxuICBjb25zdCBjYXJkRGF0YSA9IHtcbiAgICBuYW1lOiBhZGRDYXJkTmFtZUlucHV0LnZhbHVlLFxuICAgIGxpbms6IGFkZENhcmRMaW5rSW5wdXQudmFsdWUsXG4gIH07XG4gIGFwaVxuICAgIC5hZGRDYXJkKGNhcmREYXRhKVxuICAgIC50aGVuKChuZXdDYXJkKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KG5ld0NhcmQpO1xuICAgICAgY2FyZExpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XG4gICAgICBhZGRDYXJkRm9ybS5yZXNldCgpO1xuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGRpc2FibGVCdXR0b24oc3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XG4gICAgICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSk7XG5cbiAgYXBpXG4gICAgLmVkaXRBdmF0YXJJbmZvKGF2YXRhcklucHV0LnZhbHVlKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XG4gIHNlbGVjdGVkQ2FyZCA9IGNhcmRFbGVtZW50O1xuICBzZWxlY3RlZENhcmRJZCA9IGNhcmRJZDtcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZShldnQsIGlkKSB7XG4gIC8vIGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuICBjb25zdCBpc0xpa2VkID0gZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcblxuICBhcGlcbiAgICAuY2hhbmdlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZClcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVzY2FwZVByZXNzKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgY2xvc2VNb2RhbChvcGVuZWRNb2RhbCk7XG4gIH1cbn1cblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5uYW1lLnRleHRDb250ZW50O1xuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24oXG4gICAgW2VkaXRNb2RhbE5hbWVJbnB1dCwgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dF0sXG4gICAgZWRpdEZvcm1FbGVtZW50XG4gICk7XG4gIG9wZW5Nb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbn0pO1xuXG5lZGl0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XG5cbi8vaW5pdGFsQ2FyZHMuZm9yRWFjaCB3YXMgaGVyZVxuXG5jYXJkQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xufSk7XG5cbmFkZENhcmRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5cbnByb2ZpbGVBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcbn0pO1xuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XG5cbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuXG5tb2RhbExpc3QuZm9yRWFjaCgobW9kYWwpID0+IHtcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xuICAgIH1cbiAgfSk7XG59KTtcblxubW9kYWxMaXN0LmZvckVhY2goKG1vZGFsKSA9PiB7XG4gIGNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2FuY2VsLWJ1dHRvblwiKSkge1xuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XG4gICAgfVxuICB9KTtcbn0pO1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBnZXRBcHBJbmZvKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbXG4gICAgICB0aGlzLmdldEluaXRpYWxDYXJkcygpLFxuICAgICAgdGhpcy5nZXRVc2VySW5mbygpLFxuICAgICAgdGhpcy5lZGl0VXNlckluZm8sXG4gICAgXSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS91c2Vycy9tZVwiLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZWRpdEF2YXRhckluZm8oYXZhdGFyKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgY2hhbmdlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpO1xuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwiY29uZmlnIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImlucHV0RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsImRlZnVhbHRUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibG9hZGluZ1RleHQiLCJnZXRFbGVtZW50QnlJZCIsInNyYyIsInNwb3RzTG9nb1NyYyIsInByb2ZpbGVBdmF0YXIiLCJwcm9maWxlQXZhdGFyU3JjIiwiZWRpdFBlbmNpbEljb25TcmMiLCJlZGl0UGVuY2lsTGlnaHRJY29uU3JjIiwicGx1c0ljb25TcmMiLCJtb2RhbExpc3QiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVObmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImVkaXRQcm9maWxlTW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWxOYW1lSW5wdXQiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUF2YXRhckJ0biIsImNhcmRUZW1wbGF0ZSIsImNhcmRMaXN0IiwiY2FyZE1vZGFsIiwiY2FyZEFkZEJ1dHRvbiIsImFkZENhcmRGb3JtIiwiYWRkQ2FyZExpbmtJbnB1dCIsImFkZENhcmROYW1lSW5wdXQiLCJzdWJtaXRCdXR0b24iLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3TW9kYWxJbWciLCJwcmV2aWV3TW9kYWxDYXB0aW9uIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJGb3JtIiwiYXZhdGFySW5wdXQiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJjbG9zZUJ1dHRvbnMiLCJvdXR0ZXJNb2RhbENsb3NlQnV0dG9ucyIsImNhbmNlbEJ1dHRvbiIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwidXNlcklkIiwiYXBpIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJlZGl0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJfcmVmMiIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJkZWxldGVDYXJkIiwiYWRkQ2FyZCIsIl9yZWYzIiwibGluayIsImNoYW5nZUxpa2VTdGF0dXMiLCJpc0xpa2VkIiwiYXV0aG9yaXphdGlvbiIsImdldENhcmRFbGVtZW50IiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmROYW1lRWwiLCJjYXJkSW1nRWwiLCJjYXJkTGlrZUJ1dHRvbiIsImNhcmREZWxldGVCdXR0b24iLCJhbHQiLCJvcGVuTW9kYWwiLCJldnQiLCJ0YXJnZXQiLCJjb250YWlucyIsInRvZ2dsZSIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiaGFuZGxlTGlrZSIsIl9pZCIsImNhcmRJZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJtb2RhbCIsImhhbmRsZUVzY2FwZVByZXNzIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJjYXJkcyIsInVzZXJJbmZvIiwiaXRlbSIsInByZXBlbmQiLCJidXR0b24iLCJwb3B1cCIsImNsb3Nlc3QiLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnRuIiwic3VibWl0dGVyIiwiZmluYWxseSIsImNhcmREYXRhIiwibmV3Q2FyZCIsInJlc2V0IiwiZXJyIiwiZXZlbnQiXSwic291cmNlUm9vdCI6IiJ9